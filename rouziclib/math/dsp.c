int32_t is_composite(int32_t x)  // returns 1 if x is only made of these small primes
{
	int32_t i;
	const int p[3]={2, 3, 5};

	for (i=0; i<3; i++)
		while (x%p[i] == 0)
			x/=p[i];

	return x;
}

int32_t next_composite(int32_t x)   // returns the next integer only made of small primes
{
	while (is_composite(x)!=1)
		x++;

	return x;
}

int32_t next_fast_fft_size(int32_t x)	// returns the next size >= x with which a FFT runs with the lowest execution time 
{
	const int32_t fft_size[] = {64, 72, 80, 90, 96, 100, 120, 125, 128, 135, 144, 150, 160, 180, 200, 225, 240, 250, 256, 270, 300, 320, 324, 360, 375, 400, 405, 432, 450, 480, 500, 512, 540, 576, 625, 640, 648, 720, 768, 800, 810, 864, 900, 960, 972, 1000, 1080, 1125, 1152, 1200, 1215, 1280, 1296, 1350, 1440, 1500, 1600, 1620, 1728, 1800, 1920, 2000, 2025, 2160, 2304, 2400, 2500, 2560, 2700, 2880, 3000, 3200, 3375, 3600, 3840, 4000, 4500, 4800, 4860, 5000, 5184, 5625, 6000, 6400, 6480, 6561, 7500, 8000, 8100, 8640, 8748, 9375, 10000, 10125, 10800, 10935, 11520, 12500, 12960, 13500, 14400, 14580, 15625, 16000, 16200, 17280, 18000, 18225, 19440, 20000, 20736, 21600, 22500, 23040, 24300, 25920, 27000, 28800, 30000, 30375, 32400, 34560, 36000, 37500, 38400, 40000, 40500, 43200, 43740, 45000, 48000, 50000, 50625, 54000, 54675, 56250, 57600, 58320, 60000, 62500, 64000, 67500, 72000, 72900, 75000, 80000, 84375, 90000, 96000, 97200, 100000, 103680, 104976, 112500, 120000, 125000, 129600, 131220, 140625, 150000, 160000, 162000, 164025, 174960, 187500, 200000, 202500, 207360, 216000, 218700, 234375, 250000, 259200, 270000, 273375, 291600, 312500, 324000, 337500, 345600, 360000, 364500, 390625, 405000, 421875, 432000, 450000, 455625, 486000, 518400, 540000, 562500, 576000, 607500, 648000, 675000, 703125, 720000, 759375, 781250, 800000, 810000, 843750, 864000, 900000, 937500, 1000000, 1012500, 1080000, 1125000, 1171875, 1200000, 1250000, 1265625, 1280000, 1350000, 1406250, 1440000, 1500000, 1562500, 1600000, 1687500, 1875000, 2000000, 2109375, 2250000, 2343750, 2400000, 2500000, 2531250, 2812500, 3125000, 3200000, 3515625, 3750000, 3906250, 4000000, 4100625, 4687500, 5000000, 5062500, 5184000, 5400000, 5467500, 5859375, 6250000, 6328125, 6480000, 6561000, 6635520};

	const int count = sizeof(fft_size) / sizeof(fft_size[0]);
	int i;

	for (i=0; i<count; i++)
		if (fft_size[i] >= x)
			return fft_size[i];

	return next_composite(x);	// if the requested size is larger than the largest table entry then fine the next suitable composite number
}
